<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Vendeur</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#e6f0ff}
header{background:#1E3A8A;color:white;padding:16px;text-align:center}
.profile{
  background:white;
  margin:16px;
  padding:16px;
  border-radius:12px;
  text-align:center;
}
.profile img{
  width:80px;height:80px;
  border-radius:50%;
  object-fit:cover;
}
.profile h2{color:#1E3A8A}

.products{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
  padding:16px;
}
.card{
  background:white;
  border-radius:12px;
  padding:8px;
  cursor:pointer;
}
.card img{
  width:100%;
  height:110px;
  object-fit:cover;
  border-radius:10px;
}
</style>
</head>

<body>

<header>Vendeur</header>

<div class="profile">
  <img id="avatar">
  <h2 id="name"></h2>
  <p id="phone"></p>
</div>

<div class="products" id="products"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const app = initializeApp({
  apiKey:"AIzaSyA45eoz8QZbHdFlOmuK6l6yjfJC3JaF2jQ",
  databaseURL:"https://collibri-buisiness-default-rtdb.firebaseio.com",
  projectId:"collibri-buisiness"
});

const db = getDatabase(app);
const vendeurId = new URLSearchParams(location.search).get("id");

async function load(){
  const u = await get(ref(db,"users/"+vendeurId));
  if(u.exists()){
    avatar.src=u.val().avatarBase64||"";
    name.textContent=u.val().business||u.val().nom;
    phone.textContent=u.val().phone||"";
  }

  const p = await get(ref(db,"produits"));
  if(p.exists()){
    Object.entries(p.val())
      .filter(([_,v])=>v.vendeurId===vendeurId)
      .forEach(([id,v])=>{
        const d=document.createElement("div");
        d.className="card";
        d.innerHTML=`<img src="${v.image}"><div>${v.nom}</div>`;
        d.onclick=()=>location.href=`produit.html?id=${id}`;
        products.appendChild(d);
      });
  }
}
load();
</script>

</body>
</html>
